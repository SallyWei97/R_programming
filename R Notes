# Introduction to R programming language and data analysis----------------------
# Creater: Wei Zheng
# This note is created based on a video, Introduction to R programming language 
# and data analysis, on the website of Bilibili (id: åŸºå› å­¦é™¢).

# P1-6    Introduction of R-----------------------------------------------------

getwd()
# çœ‹è·¯å¾„
setwd(dir="")
ä¿®æ”¹ä¿å­˜è·¯å¾„

df <- read.table("dataname.cvs", sep=",", header = T)
# dfå°†æ•°æ®æ–‡ä»¶å‘½å
# read.table()è¯»å†™Excelæ•°æ®æ–‡ä»¶
# sep=","æ¥è¡¨ç¤ºç©ºæ ¼ç”¨å­—ç¬¦

table(df$supp, df$dose)
# table()ç”¨äºåˆ¶ä½œæ–°è¡¨æ ¼ï¼Œ$ç”¨äºç»Ÿè®¡æ€»é‡
# aggregate()æµ‹é‡å‡å€¼ã€æ–¹å·®ç­‰

# å†…ç½®æ•°æ®é›† ç²‰è‰²
# æ•°æ®æ¡† è¡¨æ ¼å›¾æ¡ˆ
# å‡½æ•° è“è‰²
# tabé”®è‡ªåŠ¨è¡¥é½ï¼ˆç¬¬ä¸€ä¸ªï¼‰

# å¿«æ·é”®
# Ctrl+â†‘ï¼Œè°ƒå‡ºå†å²è®°å½•ï¼ˆå¯è¾“å…¥æ¡ä»¶åå†æ‰§è¡Œï¼Œå³å¯æŸ¥æ‰¾ç¬¦åˆæ¡ä»¶çš„å†å²è®°å½•
# ESCä¸­æ–­å½“å‰æ“ä½œ
# Alt+shift+kï¼Œè°ƒå‡ºæ‰€æœ‰å¿«æ·æ“ä½œ


# P7-14   Rçš„å®‰è£…--------------------------------------------------------------

# - ç”¨ "<-" èµ‹å€¼ç»™ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œä¸å»ºè®®ä½¿ç”¨=
# - ç”¨ "<<-" èµ‹å€¼ç»™ä¸€ä¸ªå…¨å±€å˜é‡
# - "<-"çš„å¿«æ·é”®ï¼šalt + - 

mean()
# mean(1:5) -> 3 æ±‚1-5çš„å¹³å‡æ•°
# mean(1,2,3,4,5) -> 1 åªè¾“å‡ºç¬¬ä¸€ä¸ªå‘é‡ï¼ˆ1ï¼‰çš„å¹³å‡æ•°ï¼Œåé¢ä¸ºæ— æ•ˆè¾“å…¥
# mean(c(1,2,3,4,5)) -> 3 å¢åŠ çš„c()å¸®åŠ©è¯†åˆ«ä¸€ä¸²æ•°å­—

ls()
# åˆ—å‡ºæ‰€æœ‰å˜é‡

ls.str()
# åˆ—å‡ºæ‰€æœ‰å˜é‡çš„è¯¦ç»†ä¿¡æ¯

str()
# æ‹¬å·é‡Œå¡«å†™å˜é‡åï¼Œè¾“å‡ºå˜é‡çš„ä¿¡æ¯

rm()
# æ¸…é™¤æŸä¸ªå˜é‡

rm(list = ls())
# æ¶ˆé™¤æ‰€æœ‰å˜é‡

history()
# å”¤å‡ºå†å²

# æ¸…ç©ºç•Œé¢å¿«æ·é”® Ctrl+L


save.image()
# ä¿å­˜å·¥ä½œç©ºé—´ï¼ˆå›¾ç‰‡ä¸ä¼šè‡ªåŠ¨ä¿å­˜ï¼‰

# Ræ‹“å±•åŒ…å®‰è£…
# - åœ¨çº¿
#   é€šè¿‡è®¿é—®é•œåƒç«™ç‚¹
#   æ‹“å±•åŒ…çš„åå­—éƒ½éœ€è¦è¢«å¼•å·
    install.package()
    # eg. install.package("vcd")
    install.packages()
    # eg. install.packages(c("a", "b", "c"))
# - ç¦»çº¿ï¼ˆæºä»£ç ï¼‰
#   é•œåƒç«™ç‚¹ä¸‹è½½æºä»£ç 
#   éœ€è¦æ³¨æ„åŒ…ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ˆé€šå¸¸æ¨èåœ¨çº¿å®‰è£…ï¼‰

require()
# åŠ è½½åŒ…ï¼ˆeg. require(vcd)ï¼‰
library()
# åŠ è½½åŒ…
# libraryå’Œrequireéƒ½å¯ä»¥è½½å…¥åŒ…ï¼Œä½†äºŒè€…å­˜åœ¨åŒºåˆ«ã€‚
# ä¸€ä¸ªå‡½æ•°ä¸­ï¼Œå¦‚æœä¸€ä¸ªåŒ…ä¸å­˜åœ¨ï¼Œæ‰§è¡Œåˆ°libraryå°†ä¼šåœæ­¢æ‰§è¡Œï¼Œrequireåˆ™ä¼šç»§ç»­æ‰§è¡Œ

help(package="")
# æŸ¥è¯¢è¯¥åŒ…çš„æŒ‡å—(eg. help(package="vcd"))
library(help="")
# æŸ¥è¯¢åŒ…çš„åŸºç¡€ä¿¡æ¯ï¼Œå¦‚æ•°æ®é›†(eg. library(help=""))
# eg. Baseball (vcdè‡ªå¸¦æ•°æ®é›†ï¼‰

detach() # eg. detach("package:vcd")
# ä»å†…å­˜å†…ç§»é™¤ï¼Œé‡æ–°requireå³å¯ä½¿ç”¨
remove.packages() # eg. remove.packages("vcd")
# å½»åº•åˆ é™¤åŒ…

installed.packages()
# å¯ç”¨äºæ‹“å±•åŒ…ç§»æ¤ï¼Œ
# eg. 
Rpack <- installed.packages()[,1]
# åˆ›å»ºå˜é‡Rpackï¼Œä¸ºå½“å‰æ‰€æœ‰å·²å®‰è£…åŒ…çš„åç§°ï¼ˆç¬¬ä¸€åˆ—ï¼‰
save(Rpack,file="Rpack.Rdata")
# ä¿å­˜å˜é‡Rpack
load("C:/Users/three/Documents/Rpack.Rdata")
# åŠ è½½è¯¥å˜é‡ï¼ˆéœ€è¦ç§»æ¤çš„æ–°ç”µè„‘ï¼‰
Rpack
# æŸ¥çœ‹è¯¥å˜é‡ï¼ˆéœ€è¦ç§»æ¤çš„æ–°ç”µè„‘ï¼‰
for (x in Rpack) install.packages(x)
# ä½¿ç”¨å¾ªç¯æ¥å®‰è£…Rpackä¸­æ‰€æœ‰åŒ…ï¼ˆéœ€è¦ç§»æ¤çš„æ–°ç”µè„‘ï¼‰

# ?å‡½æ•°åï¼ˆä¸€ä¸ªé—®å·æŸ¥å‡½æ•°ï¼‰eg. 
?mean
# exampleï¼ˆï¼‰æŸ¥çœ‹å‡½æ•°çš„example eg.
example(mean)
# vignette() æŸ¥çœ‹åŒ…çš„è¯´æ˜(éƒ¨åˆ†åŒ…æ²¡æœ‰è¯¥æ ¼å¼çš„introï¼‰ eg.
vignette("xts")
# ??å‡½æ•°åï¼ˆä¸¤ä¸ªé—®å¥½æŸ¥æ‹“å±•åŒ…ï¼‰eg. ??heatmap

apropos()
# æŸ¥è¯¢æ‹¬å·å†…çš„å…³é”®å­— eg.
apprpos("sum",mod="function")
# æŸ¥è¯¢å…³é”®å­—ä¸ºsumçš„å‡½æ•°

RsiteSearch()
# å®˜ç½‘æŸ¥è¯¢å…³é”®å­—
# å¯ä½¿ç”¨rseek.orgç½‘ç«™ï¼Œéœ€è¦vpn

# æ•°æ®é€šå¸¸è¡Œæ˜¯è§‚æµ‹å€¼ï¼Œåˆ—æ˜¯å˜é‡å€¼

# P15 å†…ç½®æ•°æ®é›† --------------------------------------------------------------

# å†…ç½®æ•°æ®é›†éƒ½å­˜åœ¨datasetsåŒ…
data()
#  è¾“å‡ºæ‰€æœ‰åŒ…å«çš„æ•°æ®é›†
rivers
eg. å†…ç½®æ•°æ®é›†-åŒ—ç¾æ²³æµé•¿åº¦
data("")
#  è¾“å‡ºé€‰å®šæ•°æ®é›† eg. data("rivers")

# ç½‘ç›˜æœ‰æ•°æ®é›†æ•´ç†
class()
# æŸ¥çœ‹æ•°æ®é›†çš„ç±»å‹(å‘é‡ã€å› å­ã€çŸ©é˜µç­‰

heatmap()
# ç»˜åˆ¶æ•°æ®é›†çš„çƒ­åŠ›å›¾ eg. heatmap(volcano)

data(package=.packages(all.available=TRUE))
# æŸ¥æ‰¾æ‰€æœ‰å¯ç”¨æ•°æ®é›†

data.frame()
# åˆ¶ä½œæ•°æ®æ¡†

data(database,package="ç¨‹åºåŒ…"ï¼‰
# åªåŠ è½½æ‹“å±•åŒ…é‡Œé¢çš„æ•°æ®é›†ï¼Œå¿½ç•¥åŒ…

# P16-26  ç¼–ç¨‹åŸºç¡€æ¦‚å¿µ----------------------------------------------------------------------------------------------------------------------------------------------------------

# æ•°æ®ç±»å‹
# æ•°å€¼ï¼Œï¼Œé€»è¾‘å‹ï¼ˆå¸ƒå°”ï¼‰ï¼Œæ—¥æœŸå‹

# å¯¹è±¡
# eg. å¸¸é‡ï¼Œæ•°æ®ç»“æ„ï¼Œå‡½æ•°ï¼Œå›¾å½¢

# æ•°æ®ç»“æ„
# eg. å‘é‡ï¼Œæ ‡é‡ï¼›çŸ©é˜µï¼›æ•°ç»„ï¼›åˆ—è¡¨ï¼›æ•°æ®æ¡†ï¼›å› å­ï¼›æ—¶é—´åºåˆ—

# 1.1 å‘é‡ vector---------------------------------------
# å­˜å‚¨æ•°å€¼å‹å­—ç¬¦å‹ç­‰æ•°æ®çš„ä¸€ç»´æ•°ç»„
# ç”¨å‡½æ•°c()æ¥åˆ›å»ºå‘é‡ï¼ˆæ•°ç»„ï¼‰eg.
x <- c(1,2,20,21,22,31,24,44,25,32,27)
y <- c("one","two")
z <- c(TRUE,F,T,F)
# !!å­—ç¬¦ä¸²å¿…é¡»ï¼‹â€œâ€
# !!é€»è¾‘å‹å¿…é¡»allå¤§å†™
c(1:100)
# 1-100ç­‰å·®æ•°åˆ—
seq (from=1,to=100,by=4)
seq (from=1,to=100,length.out=8)
# byä¸ºç­‰å·®æ•°åˆ—çš„å·®ï¼Œlength.outä¸ºç­‰å·®æ•°åˆ—ä¸ªæ•°
rep(x,5)
rep(x,each=5ï¼Œtimes=5)
# é‡å¤å‡½æ•°ï¼Œxå¯ä¸ºæ ‡é‡ã€å‘é‡ï¼Œeachæ˜¯å•ä¸ªé‡å¤æ¬¡æ•°ï¼Œtimesæ˜¯æ€»ä½“é‡å¤æ¬¡æ•°
a <- c(1,2,"three")
# 1,2è¢«è½¬åŒ–ä¸ºå­—ç¬¦ä¸²
model()
# æŸ¥çœ‹å‘é‡çš„ç±»å‹
# ï¼ï¼Ræ˜¯å‘é‡åŒ–ç¼–ç¨‹ï¼Œä¼˜åŠ¿æ˜¯é¿å…ä½¿ç”¨å¾ªç¯
> x <- c(1,2)
> y <- c(3,4)
> x*3+y
[1]  6 10
> x[x<2]
[1] 1
> rep(x,c(2,3))
[1] 1 1 2 2 2


# 1.2 å‘é‡ç´¢å¼• ---------------------------------------
# æ­£è´Ÿæ•´æ•°ç´¢å¼•ï¼›é€»è¾‘å‘é‡ç´¢å¼•ï¼›åç§°ç´¢å¼•

# æ­£è´Ÿæ•´æ•°ç´¢å¼•
> x <- c(1:100)
> length(x)
[1] 100
> x[10]
[1] 10
> x[-66] # ä¸æ˜¾ç¤ºç¬¬66ä¸ªæ•°
 [1]   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17
[18]  18  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34
[35]  35  36  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51
[52]  52  53  54  55  56  57  58  59  60  61  62  63  64  65  67  68  69
[69]  70  71  72  73  74  75  76  77  78  79  80  81  82  83  84  85  86
[86]  87  88  89  90  91  92  93  94  95  96  97  98  99 100
> x[c(-10:-90)]
 [1]   1   2   3   4   5   6   7   8   9  91  92  93  94  95  96  97  98
[18]  99 100

# é€»è¾‘ç´¢å¼•
> y <- c(1:10)
> y[c(T,F,F,T,T)]
[1]  1  4  5  6  9 10
> y[c(T,F,F,T,T,F,F,T,T,F,F,T,T)]
[1]  1  4  5  8  9 NA NA #NAç¼ºå¤±å€¼
> y[y>7]
[1]  8  9 10
> y[y>6 & y<9]
[1] 7 8
> z <- c("one","two","three","four","five")
> "one" %in% z #åˆ¤æ–­å­—ç¬¦ä¸²â€œoneâ€æ˜¯å¦æ˜¯zçš„å…ƒç´ ï¼Œ
[1] TRUE
> z[z %in% c("one","five")] #ç›¸å½“äº y[c(T,F,F,F,T)]
[1] "one"  "five"

# åç§°ç´¢å¼•
> names(y) <- c("one","two","three","four","five","six","seven","eight","nine","ten")
> y
  one   two three  four  five   six seven eight  nine   ten 
    1     2     3     4     5     6     7     8     9    10 
> y["two"]
two 
  2
# é€šå¸¸ç”¨äºæ•°ç»„ç­‰æƒ…æ™¯ï¼Œç¬¬ä¸€è¡Œç›¸å½“äºExcelçš„åˆ—å  
  
# å‘é‡ä¿®æ”¹-------------------------------------------------------------
> x[101] <- 1000
> x
  [1]    1    2    3    4    5    6    7    8    9   10   11   12   13
 [14]   14   15   16   17   18   19   20   21   22   23   24   25   26
 [27]   27   28   29   30   31   32   33   34   35   36   37   38   39
 [40]   40   41   42   43   44   45   46   47   48   49   50   51   52
 [53]   53   54   55   56   57   58   59   60   61   62   63   64   65
 [66]   66   67   68   69   70   71   72   73   74   75   76   77   78
 [79]   79   80   81   82   83   84   85   86   87   88   89   90   91
 [92]   92   93   94   95   96   97   98   99  100 1000
# èµ‹å€¼å•ä¸ªå‘é‡

> b <- 1:3
> b[c(4:10)] <- c(1,1,2,2,3,3,4)
> b
 [1] 1 2 3 1 1 2 2 3 3 4
# æ‰¹é‡èµ‹å€¼
> b[13] <- 11
> b
 [1]  1  2  3  1  1  2  2  3  3  4 NA NA 11
# ä¸­é—´ä¸ºç¼ºå¤±å€¼

> append(x = b,values = 99,after = 5)
 [1]  1  2  3  1  1 99  2  2  3  3  4 NA NA 11
# æ’å…¥å‘é‡ï¼Œtabé”®è°ƒå‡ºå‡½æ•°å‚æ•°

rm()
# åˆ é™¤æ•´ä¸ªå‘é‡
> y <- y[-c(3:5)]
> y
  one   two   six seven eight  nine   ten 
    1     2     6     7     8     9    10 
# åˆ é™¤æŸäº›å‘é‡

> y["six"] <- 99
> y
  one   two   six seven eight  nine   ten 
    1     2    99     7     8     9    10 
# ä¿®æ”¹æŸä¸ªå‘é‡å€¼

# å‘é‡è®¡ç®—------------------------------------------------------------
1.
> x <- 1:5
> x <- x*2
> x
[1]  2  4  6  8 10
> y <- seq(1,20,length.out =5)
> x*y
[1]   2  23  63 122 200
> x**y # å¹‚è¿ç®—
[1] 2.000000e+00 2.896309e+03 1.481113e+08 5.917282e+13 1.000000e+20
> y%%x # æ±‚ä½™
[1] 1.00 1.75 4.50 7.25 0.00
> y%/%x # æ•´é™¤
[1] 0 1 1 1 2
> z <- 1:3
> x+z
[1]  3  6  9  9 12
Warning message: # é•¿å‘é‡ä¸ªæ•°ä¸æ˜¯çŸ­å‘é‡çš„æ•´æ•°å€
In x + z : longer object length is not a multiple of shorter object length
# å‘é‡çš„åŠ å‡ä¹˜é™¤

2.
> c(1:3) %in% x
[1] FALSE  TRUE FALSE
# åŒ…å«è¿ç®—ç¬¦

3.
> x==y
[1] FALSE FALSE FALSE FALSE FALSE
# ç­‰äºåˆ¤æ–­ç¬¦

4.
> a <- -5:5
> abs(a)
 [1] 5 4 3 2 1 0 1 2 3 4 5
# å–ç»å¯¹å€¼
> sqrt(a)
 [1]      NaN      NaN      NaN      NaN      NaN 0.000000 1.000000
 [8] 1.414214 1.732051 2.000000 2.236068
# è®¡ç®—å¹³æ–¹æ ¹
> log(x = a,base = 2)
 [1]      NaN      NaN      NaN      NaN      NaN     -Inf 0.000000
 [8] 1.000000 1.584963 2.000000 2.321928
# è®¡ç®—å¯¹æ•°
> exp(a)
 [1] 6.737947e-03 1.831564e-02 4.978707e-02 1.353353e-01 3.678794e-01
 [6] 1.000000e+00 2.718282e+00 7.389056e+00 2.008554e+01 5.459815e+01
[11] 1.484132e+02
# ä»¥eä¸ºåº•çš„æŒ‡æ•°å‡½æ•°
> ceiling(c(1.22,2.33))
[1] 2 3
# å‘ä¸Šå–æ•´
> floor(c(1.22,2.33))
[1] 1 2
# å‘ä¸‹å–æ•´
> trunc(c(1.22,2.33))
[1] 1 2
# å»é™¤å°æ•°ç‚¹
> round(c(1.21,2.88,2.18),digits = 1)
[1] 1.2 2.9 2.2
> signif(c(1.21,2.88,2.18),digits=1)
[1] 1 3 2
# å››èˆäº”å…¥ roundï¼šdigitsä¸ºå°æ•°ç‚¹åå‡ ä½ã€‚

5.
sin()
cos()
...
# ä¸‰è§’å‡½æ•°è®¡ç®—

6. ç»Ÿè®¡å‡½æ•°
> vec <- 1:100
> sum(vec)
[1] 5050
> max(vec)
[1] 100
> min(vec)
[1] 1
> range(vec) # æœ€å¤§å€¼&æœ€å°å€¼
[1]   1 100
> mean(vec)
[1] 50.5
> var(vec) # æ–¹å·®
[1] 841.6667
> sd(vec) # æ ‡å‡†å·®
[1] 29.01149
> prod(vec) #è¿ä¹˜
[1] 9.332622e+157
> median(vec)
[1] 50.5
> quantile(vec) # åˆ†ä½æ•°
    0%    25%    50%    75%   100% 
  1.00  25.75  50.50  75.25 100.00 
> quantile(vec,c(0.1,0.8))
 10%  80% 
10.9 80.2 

7.æŸ¥æ‰¾å‘é‡ç´¢å¼•å€¼
> t <- c(1,3,5,7,9,11,13)
> which.max(t)
[1] 7
> which(t==7)
[1] 4
> which(t<mean(t))
[1] 1 2 3
> t[which(t<10)] # å…ˆè¾“å‡ºç¬¦åˆæ¡ä»¶çš„ç´¢å¼•å€¼ï¼Œå†æŒ‰ç´¢å¼•å€¼è¾“å‡ºå‘é‡
[1] 1 3 5 7 9

# 2 çŸ©é˜µ --------------------------------------------------

1.æ„å»ºçŸ©é˜µ
1.1 matrix
> m <- matrix(1:30,5,6) # 5æ˜¯nrowè¡Œæ•°ï¼Œ6æ˜¯ncolåˆ—æ•°
> m
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    6   11   16   21   26
[2,]    2    7   12   17   22   27
[3,]    3    8   13   18   23   28
[4,]    4    9   14   19   24   29
[5,]    5   10   15   20   25   30
# è¡Œåˆ—æ•°è¦ä¸å‘é‡æ€»æ•°åŒ¹é…
>  m <- matrix(1:30,5,byrow = T) # æŒ‰è¡Œåˆ†é…
> m
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    2    3    4    5    6
[2,]    7    8    9   10   11   12
[3,]   13   14   15   16   17   18
[4,]   19   20   21   22   23   24
[5,]   25   26   27   28   29   30
> m <- matrix(1:30,5,byrow = F)
> m
     [,1] [,2] [,3] [,4] [,5] [,6]
[1,]    1    6   11   16   21   26
[2,]    2    7   12   17   22   27
[3,]    3    8   13   18   23   28
[4,]    4    9   14   19   24   29
[5,]    5   10   15   20   25   30
# æŒ‰åˆ—åˆ†é…
> rnames <- c("R1","R2","R3","R4","R5")
> cnames <- c("C1","C2","C3","C4","C5","C6")
> dimnames(m) <- list(rnames,cnames)
> m
   C1 C2 C3 C4 C5 C6
R1  1  6 11 16 21 26
R2  2  7 12 17 22 27
R3  3  8 13 18 23 28
R4  4  9 14 19 24 29
R5  5 10 15 20 25 30
# ç»™çŸ©é˜µè¡Œåˆ—å‘½å

1.2 dim
> x <- 1:8
> dim(x) <- c(2,2,2)
> x
, , 1

     [,1] [,2]
[1,]    1    3
[2,]    2    4

, , 2

     [,1] [,2]
[1,]    5    7
[2,]    6    8
# dimå®šä¹‰ç»´åº¦ï¼Œå¯ä»¥æ˜¯nç»´

1.3 array
> dim1 <- c("A1","A2")
> dim2 <- c("B1","B2","B3")
> dim3 <- c("C1","C2","C3","C4")
> h <- array(1:24,c(2,3,4),dimnames = list(dim1,dim2,dim3)) # 1:24-çŸ©é˜µçš„å€¼; c(2,3,4)-çŸ©é˜µçš„ç»´åº¦; dimnames-çŸ©é˜µçš„ç»´åº¦åç§°
> h
, , C1

   B1 B2 B3
A1  1  3  5
A2  2  4  6

, , C2

   B1 B2 B3
A1  7  9 11
A2  8 10 12

, , C3

   B1 B2 B3
A1 13 15 17
A2 14 16 18

, , C4

   B1 B2 B3
A1 19 21 23
A2 20 22 24

2.çŸ©é˜µç´¢å¼•
2.1 çŸ©é˜µä¸‹æ ‡
> m <- matrix(1:20,4,5,byrow = T)
> m
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    2    3    4    5
[2,]    6    7    8    9   10
[3,]   11   12   13   14   15
[4,]   16   17   18   19   20
> m[1,3]
[1] 3
> m[2,c(1:3)]
[1] 6 7 8
> m[,3]
[1]  3  8 13 18
> m[-1,2]
[1]  7 12 17
> m
   C1 C2 C3 C4 C5
R1  1  2  3  4  5
R2  6  7  8  9 10
R3 11 12 13 14 15
R4 16 17 18 19 20
> m["R2","C5"] # é€šè¿‡ç»´åº¦åè¿›è¡Œç´¢å¼•
[1] 10
> a <- head(state.x77) # headå–å¯¹è±¡çš„first part
> a[,"Income"]
   Alabama     Alaska    Arizona   Arkansas California   Colorado 
      3624       6315       4530       3378       5114       4884 
      
2.2çŸ©é˜µè¿ç®—
# åŠ å‡æ³•ï¼šè¡Œåˆ—å¿…é¡»ä¸€è‡´
> m
   C1 C2 C3 C4 C5
R1  1  2  3  4  5
R2  6  7  8  9 10
R3 11 12 13 14 15
R4 16 17 18 19 20
> colSums(m) # è®¡ç®—æ¯ä¸€åˆ—çš„å’Œ
C1 C2 C3 C4 C5 
34 38 42 46 50 
> rowSums(m) # è®¡ç®—æ¯ä¸€è¡Œçš„å’Œ
R1 R2 R3 R4 
15 40 65 90 
> colMeans(m) # è®¡ç®—æ¯ä¸€åˆ—çš„å‡å€¼
  C1   C2   C3   C4   C5 
 8.5  9.5 10.5 11.5 12.5 
> rowMeans(m) # è®¡ç®—æ¯ä¸€è¡Œçš„å‡å€¼
R1 R2 R3 R4 
 3  8 13 18 
 
 # çŸ©é˜µçš„ä¹˜æ³•
 > m*m
    C1  C2  C3  C4  C5
R1   1   4   9  16  25
R2  36  49  64  81 100
R3 121 144 169 196 225
R4 256 289 324 361 400
# å†…ç§¯
> n <- matrix(1:20,5,4)
> m %*% n
   [,1] [,2] [,3] [,4]
R1   55  130  205  280
R2  130  330  530  730
R3  205  530  855 1180
R4  280  730 1180 1630
# å¤–ç§¯

# å–å¯¹è§’çº¿
> diag(n)
[1]  1  7 13 19

# è½¬ç½®
> t(m)
   R1 R2 R3 R4
C1  1  6 11 16
C2  2  7 12 17
C3  3  8 13 18
C4  4  9 14 19
C5  5 10 15 20

3. åˆ—è¡¨ --------------------------------------------------
# åˆ—è¡¨æ˜¯å¯¹è±¡çš„é›†åˆï¼Œå¯ä»¥æ˜¯ä»»ä½•æ•°æ®ç»“æ„ï¼Œç”šè‡³åˆ—è¡¨æœ¬èº«

3.1 åˆ›å»ºåˆ—è¡¨
> a <- 1:20
> b <- matrix(1:20,4)
> c <- mtcars
> d <- "This is a test list"
> a;b;c;d
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    5    9   13   17
[2,]    2    6   10   14   18
[3,]    3    7   11   15   19
[4,]    4    8   12   16   20
                     mpg cyl  disp  hp drat    wt  qsec vs am gear carb
Mazda RX4           21.0   6 160.0 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag       21.0   6 160.0 110 3.90 2.875 17.02  0  1    4    4
Datsun 710          22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive      21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout   18.7   8 360.0 175 3.15 3.440 17.02  0  0    3    2
Valiant             18.1   6 225.0 105 2.76 3.460 20.22  1  0    3    1
Duster 360          14.3   8 360.0 245 3.21 3.570 15.84  0  0    3    4
Merc 240D           24.4   4 146.7  62 3.69 3.190 20.00  1  0    4    2
Merc 230            22.8   4 140.8  95 3.92 3.150 22.90  1  0    4    2
Merc 280            19.2   6 167.6 123 3.92 3.440 18.30  1  0    4    4
Merc 280C           17.8   6 167.6 123 3.92 3.440 18.90  1  0    4    4
Merc 450SE          16.4   8 275.8 180 3.07 4.070 17.40  0  0    3    3
Merc 450SL          17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3
Merc 450SLC         15.2   8 275.8 180 3.07 3.780 18.00  0  0    3    3
Cadillac Fleetwood  10.4   8 472.0 205 2.93 5.250 17.98  0  0    3    4
Lincoln Continental 10.4   8 460.0 215 3.00 5.424 17.82  0  0    3    4
Chrysler Imperial   14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
Fiat 128            32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
Honda Civic         30.4   4  75.7  52 4.93 1.615 18.52  1  1    4    2
Toyota Corolla      33.9   4  71.1  65 4.22 1.835 19.90  1  1    4    1
Toyota Corona       21.5   4 120.1  97 3.70 2.465 20.01  1  0    3    1
Dodge Challenger    15.5   8 318.0 150 2.76 3.520 16.87  0  0    3    2
AMC Javelin         15.2   8 304.0 150 3.15 3.435 17.30  0  0    3    2
Camaro Z28          13.3   8 350.0 245 3.73 3.840 15.41  0  0    3    4
Pontiac Firebird    19.2   8 400.0 175 3.08 3.845 17.05  0  0    3    2
Fiat X1-9           27.3   4  79.0  66 4.08 1.935 18.90  1  1    4    1
Porsche 914-2       26.0   4 120.3  91 4.43 2.140 16.70  0  1    5    2
Lotus Europa        30.4   4  95.1 113 3.77 1.513 16.90  1  1    5    2
Ford Pantera L      15.8   8 351.0 264 4.22 3.170 14.50  0  1    5    4
Ferrari Dino        19.7   6 145.0 175 3.62 2.770 15.50  0  1    5    6
Maserati Bora       15.0   8 301.0 335 3.54 3.570 14.60  0  1    5    8
Volvo 142E          21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
[1] "This is a test list"
> mlist <- list(a,b,c,d)
# listå‡½æ•°åˆ›å»ºåˆ—è¡¨

3.2 è®¿é—®åˆ—è¡¨
# ç´¢å¼•è®¿é—®
> mlist[1]
[[1]]
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
> mlist[c(1,2)]
[[1]]
 [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20

[[2]]
     [,1] [,2] [,3] [,4] [,5]
[1,]    1    5    9   13   17
[2,]    2    6   10   14   18
[3,]    3    7   11   15   19
[4,]    4    8   12   16   20
# é€šè¿‡å‘é‡æ¥ç´¢å¼•åˆ—è¡¨ä¸­çš„å¤šä¸ªå¯¹è±¡

# åç§°è®¿é—®
> state.center["y"]
$y
 [1] 32.5901 49.2500 34.2192 34.7336 36.5341 38.6777 41.5928 38.6777 27.8744 32.3329 31.7500
[12] 43.5648 40.0495 40.0495 41.9358 38.4204 37.3915 30.6181 45.6226 39.2778 42.3645 43.1361
[23] 46.3943 32.6758 38.3347 46.8230 41.3356 39.1063 43.3934 39.9637 34.4764 43.1361 35.4195
[34] 47.2517 40.2210 35.5053 43.9078 40.9069 41.5928 33.6190 44.3365 35.6767 31.3897 39.1063
[45] 44.2508 37.5630 47.4231 38.4204 44.5937 43.0504

# $è®¿é—®
# è¾“å…¥åˆ—è¡¨ååè¾“å…¥$,ä¼šå¸¦å‡ºåˆ—è¡¨å…¨éƒ¨å¯¹è±¡çš„åç§°ï¼Œé€‰æ‹©åå›è½¦å³å¯

# åŒ[]è®¿é—®
# []è¾“å‡ºçš„ä¾ç„¶æ˜¯åˆ—è¡¨ï¼ˆçš„å­é›†ï¼‰
# [[]]è¾“å‡ºçš„æ˜¯å¯¹è±¡æœ¬èº«çš„æ•°æ®ç±»å‹

3.2 ç¼–è¾‘åˆ—è¡¨
mlist[[5]] <- iris
# æ–°å¢å¯¹è±¡ï¼Œæ³¨æ„åŒ[]

> mlist <- mlist[-5]
> mlist[[4]] <- NULL
# åˆ é™¤å¯¹è±¡

4.æ•°æ®æ¡† --------------------------------------------------
# ç±»ä¼¼spssæ•°æ®é›†ï¼ŒçŸ©å½¢ç»“æ„ï¼Œåˆ—å¿…é¡»å‘½å
# æ•°æ®å¯ä»¥ä¸æ˜¯åŒä¸€ç§æ•°æ®ç±»å‹ï¼ˆå­—ç¬¦ä¸²ï¼Œæ•°å€¼ï¼Œé€»è¾‘å€¼ç­‰ï¼‰
# æ¯ä¸€åˆ—å¿…é¡»æ˜¯åŒä¸€ç§æ•°æ®ç±»å‹

4.1 åˆ›å»ºæ•°æ®æ¡†
state <- data.frame(state.area,state.name,state.region)
> state
   state.area     state.name  state.region
1       51609        Alabama         South
2      589757         Alaska          West
3      113909        Arizona          West
4       53104       Arkansas         South
5      158693     California          West
6      104247       Colorado          West
7        5009    Connecticut     Northeast
8        2057       Delaware         South
9       58560        Florida         South
10      58876        Georgia         South
11       6450         Hawaii          West
12      83557          Idaho          West
13      56400       Illinois North Central
14      36291        Indiana North Central
15      56290           Iowa North Central
16      82264         Kansas North Central
17      40395       Kentucky         South
18      48523      Louisiana         South
19      33215          Maine     Northeast
20      10577       Maryland         South
21       8257  Massachusetts     Northeast
22      58216       Michigan North Central
23      84068      Minnesota North Central
24      47716    Mississippi         South
25      69686       Missouri North Central
26     147138        Montana          West
27      77227       Nebraska North Central
28     110540         Nevada          West
29       9304  New Hampshire     Northeast
30       7836     New Jersey     Northeast
31     121666     New Mexico          West
32      49576       New York     Northeast
33      52586 North Carolina         South
34      70665   North Dakota North Central
35      41222           Ohio North Central
36      69919       Oklahoma         South
37      96981         Oregon          West
38      45333   Pennsylvania     Northeast
39       1214   Rhode Island     Northeast
40      31055 South Carolina         South
41      77047   South Dakota North Central
42      42244      Tennessee         South
43     267339          Texas         South
44      84916           Utah          West
45       9609        Vermont     Northeast
46      40815       Virginia         South
47      68192     Washington          West
48      24181  West Virginia         South
49      56154      Wisconsin North Central
50      97914        Wyoming          West

4.2 æ•°æ®æ¡†è®¿é—®
# ç´¢å¼•è®¿é—®
# åç§°è®¿é—®ï¼ˆè¡Œåˆ—åï¼‰
# $è®¿é—®
plot(women$height,women$weight) # ç»˜åˆ¶æ•£ç‚¹å›¾
lm(weight ~ height,data=women)

Call:
lm(formula = weight ~ height, data = women) # çº¿æ€§å›å½’

Coefficients:
(Intercept)       height  
     -87.52         3.45  
     
# attachåŠ è½½æ•°æ®æ¡†åˆ°Ræœç´¢ç›®å½•
> attach(mtcars)
> disp
 [1] 160.0 160.0 108.0 258.0 360.0 225.0 360.0 146.7 140.8 167.6 167.6 275.8 275.8 275.8 472.0
[16] 460.0 440.0  78.7  75.7  71.1 120.1 318.0 304.0 350.0 400.0  79.0 120.3  95.1 351.0 145.0
[31] 301.0 121.0
# detachå–æ¶ˆåŠ è½½

# withæŸ¥è¯¢
> with(mtcars,{mpg})
 [1] 21.0 21.0 22.8 21.4 18.7 18.1 14.3 24.4 22.8 19.2 17.8 16.4 17.3 15.2 10.4 10.4 14.7 32.4
[19] 30.4 33.9 21.5 15.5 15.2 13.3 19.2 27.3 26.0 30.4 15.8 19.7 15.0 21.4

5. å› å­ --------------------------------------------------
# åä¹‰å‹å˜é‡
# æœ‰åºå‹å˜é‡ ï¼ˆgood,better,bestï¼‰
# è¿ç»­å‹å˜é‡

# æ°´å¹³å€¼=å˜é‡å¯èƒ½çš„å€¼ï¼ˆé™¤è¿ç»­å‹ï¼‰
# å› å­=æ°´å¹³å€¼ç»„æˆçš„å‘é‡

# ä¸»è¦ç”¨äºä¸»æˆåˆ†åˆ†æï¼Œå› å­åˆ†æï¼Œæ–¹å·®åˆ†æç­‰

5.1 åˆ›å»ºå› å­
> week <- factor(c("Mon","Tue","Fri"))
> week
[1] Mon Tue Fri
Levels: Fri Mon Tue
> week <- factor(c("Mon","Tue","Fri"),ordered = T, levels = c("Mon","Tue","Fri"))
> week
[1] Mon Tue Fri
Levels: Mon < Tue < Fri
# ordered=T,æŒ‰levelsé¡ºåºæ’åº

> fcyl <- factor(mtcars$cyl)
> fcyl
 [1] 6 6 4 6 8 6 8 4 4 6 6 8 8 8 8 8 8 4 4 4 4 8 8 8 8 4 4 4 8 6 8 4
Levels: 4 6 8
> plot(fcyl)
# ç»˜åˆ¶çš„æ˜¯é¢‘ç‡æ¡å½¢å›¾è€Œéæ•£ç‚¹å›¾

5.2 åˆ†å‰²è¿ç»­å‹å˜é‡
> cut(x = num,breaks = c(seq(0,100,20)))
  [1] (0,20]   (0,20]   (0,20]   (0,20]   (0,20]   (0,20]   (0,20]   (0,20]   (0,20]  
 [10] (0,20]   (0,20]   (0,20]   (0,20]   (0,20]   (0,20]   (0,20]   (0,20]   (0,20]  
 [19] (0,20]   (0,20]   (20,40]  (20,40]  (20,40]  (20,40]  (20,40]  (20,40]  (20,40] 
 [28] (20,40]  (20,40]  (20,40]  (20,40]  (20,40]  (20,40]  (20,40]  (20,40]  (20,40] 
 [37] (20,40]  (20,40]  (20,40]  (20,40]  (40,60]  (40,60]  (40,60]  (40,60]  (40,60] 
 [46] (40,60]  (40,60]  (40,60]  (40,60]  (40,60]  (40,60]  (40,60]  (40,60]  (40,60] 
 [55] (40,60]  (40,60]  (40,60]  (40,60]  (40,60]  (40,60]  (60,80]  (60,80]  (60,80] 
 [64] (60,80]  (60,80]  (60,80]  (60,80]  (60,80]  (60,80]  (60,80]  (60,80]  (60,80] 
 [73] (60,80]  (60,80]  (60,80]  (60,80]  (60,80]  (60,80]  (60,80]  (60,80]  (80,100]
 [82] (80,100] (80,100] (80,100] (80,100] (80,100] (80,100] (80,100] (80,100] (80,100]
 [91] (80,100] (80,100] (80,100] (80,100] (80,100] (80,100] (80,100] (80,100] (80,100]
[100] (80,100]
Levels: (0,20] (20,40] (40,60] (60,80] (80,100]
# breaks:åˆ†å‰²æ–¹å¼ï¼Œå¯ä»¥æ˜¯å‘é‡ï¼Œæ•°å€¼

6. ç¼ºå¤±æ•°æ® --------------------------------------------------
6.1 ç®€å•å¤„ç†
> a <- c(1,NA,2:9)
> sum(a)
[1] NA
> sum(a,na.rm = TRUE)
[1] 45
> mean(a,na.rm = TRUE)
[1] 5
# ä½¿ç”¨na.rmç§»é™¤NA

> is.na(a)
 [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE
# ä½¿ç”¨is.naåˆ¤æ–­æ˜¯å¦æœ‰ç¼ºå¤±å€¼

> sum(is.na(sleep))
[1] 38
# ç»Ÿè®¡ç¼ºå¤±å€¼ä¸ªæ•°

> c <- c(1,NA,NA,2:8)
> c
 [1]  1 NA NA  2  3  4  5  6  7  8
> d <- na.omit(c)
> d
[1] 1 2 3 4 5 6 7 8
attr(,"na.action")
[1] 2 3
attr(,"class")
[1] "omit"
# omitå‡½æ•°å»é™¤ç¼ºå¤±å€¼
# omitå»é™¤æ•°æ®æ¡†çš„ç¼ºå¤±å€¼ä¼šåˆ é™¤æ•´è¡Œï¼ˆè§‚æµ‹å€¼ï¼‰

6.2 å¤„ç†ç¼ºå¤±å€¼åŒ…
# è¯†åˆ«ï¼šVIMåŒ…
# åˆ é™¤ï¼šè¡Œåˆ é™¤omit.na; é…å¯¹åˆ é™¤ï¼šéƒ¨åˆ†å‡½æ•°æœ‰å¯ç”¨é€‰é¡¹
# æœ€å¤§ä¼¼ç„¶ä¼°è®¡ï¼šmvmleåŒ…
# æ’è¡¥ï¼šå•ä¸ªæ’è¡¥ï¼šHmiscåŒ…; å¤šé‡æ’è¡¥ï¼šMiåŒ…ï¼ŒMiceåŒ…ï¼ŒameliaåŒ…ï¼ŒmitoolsåŒ…

# NaN ä¸å¯èƒ½çš„å€¼
# Inf æ— ç©·
is.nan()
is.infinite()

7. å­—ç¬¦ä¸²

7.1 ç®€å•å¤„ç†
> nchar("hello world")
[1] 11
# è®¡ç®—é•¿åº¦
length()
# è®¡ç®—å‘é‡ä¸­å…ƒç´ ä¸ªæ•°

> paste("I","Love","China")
[1] "I Love China"
> paste("I","Love","China",sep="-")
[1] "I-Love-China"
> a1 <- c("Amy","Sally")
> paste(a1,"likes rainbow")
[1] "Amy likes rainbow"   "Sally likes rainbow"
# åˆå¹¶å­—ç¬¦ä¸²ï¼Œsepæ˜¯åˆ†éš”ç¬¦ï¼Œå‘é‡ä¸å­—ç¬¦ä¸²ä¼šæŒ¨ä¸ªåˆå¹¶

> substr(x = month.name,start = 1,stop = 3)
 [1] "Jan" "Feb" "Mar" "Apr" "May" "Jun" "Jul" "Aug" "Sep" "Oct" "Nov" "Dec"
# æå–å­—ç¬¦ä¸²

toupper()
# å¤§å†™å­—ç¬¦ä¸²
tolower()
# å°å†™å­—ç¬¦ä¸²

7.2 ç‰¹æ®Šå¤„ç†ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰

# æ­£åˆ™è¡¨è¾¾å¼å…¥é—¨
# 1. [] å…è®¸åŒ¹é…ä¸€ç»„å¯èƒ½å‡ºç°çš„å­—ç¬¦ eg.[Pp]ython æ¥æŸ¥æ‰¾Pythonå’ŒPython
# 2. - ä»£è¡¨åŒºé—´ eg.[0-9A-G]åŒ¹é…0123456789å’ŒABCDEFG
# 3. \ è½¬ä¹‰ eg.[\[\]]åŒ¹é…[]
# 4. ^ å–å eg. n[^e]åŒ¹é…nåè¾¹ä¸æ˜¯eçš„æ•°æ®
# 5. \w ä¸ä»»æ„å•è¯å­—ç¬¦åŒ¹é…ï¼Œä»»æ„å•è¯å­—ç¬¦è¡¨ç¤º [A-Z]ã€ [a-z]ã€[0-9]ã€_
# 6. \d ä¸ä»»æ„æ•°å­—åŒ¹é…
# 7. \s åŒ¹é…ç©ºç™½å­—ç¬¦ï¼ˆç©ºæ ¼ï¼Œtabï¼Œæ¢è¡Œï¼‰
# 8. \b åŒ¹é…çš„æ˜¯å•è¯çš„è¾¹ç•Œ eg. \bcode\b åŒ¹é…å•çº¯çš„code
# 9. å¿«æ·æ–¹å¼å–å eg. \WåŒ¹é…ä»»æ„å•è¯å­—ç¬¦ä»¥å¤–çš„æ•°æ®,å¦‚+\=ç­‰
# 10. ^ æŒ‡å®šå­—ç¬¦ä¸²çš„å¼€å§‹ $æ˜¯ç»“æŸ
# 11. . ä»£è¡¨åŒ¹é…ä»»ä½•å•ä¸ªå­—ç¬¦ï¼Œåªèƒ½åœ¨[]å¤–
# 12. ? æœŸæœ›è¯¥å­—ç¬¦å‡ºç°é›¶æ¬¡æˆ–ä¸€æ¬¡ eg. favou?råŒ¹é…favorå’Œfavour
# 13. {N} è¡¨ç¤ºåœ¨å®ƒä¹‹å‰çš„å­—ç¬¦ç»„å‡ºç°Næ¬¡ eg.\d{4}åŒ¹é…å››ä½æ•°å­—
# 14. {M,N} é‡å¤åŒºé—´ï¼ŒMæ˜¯ä¸‹ç•Œã€‚
# é»˜è®¤è´ªå©ªæ¨¡å¼æŒ‰Nä¼˜å…ˆåŒ¹é…ï¼Œéè´ªå©ªéœ€è¦{M,N}? 
# {1,}è¡¨ç¤ºåŒ¹é…ä¸€ä¸ªæˆ–æ— æ•°ä¸ª 
# +ç­‰ä»·äº{1,}ï¼Œ*ç­‰ä»·äº{0,}

# æ­£åˆ™è¡¨è¾¾å¼è¿›é˜¶
# 1.() æ•è·åˆ†ç»„ eg. >(.*)< å¯ä»¥åŒ¹é…1>hi<1å¹¶æå–hi
# 2. | æˆ–è€…æ¡ä»¶ eg. (.avi|.mp4|.wmv|.rmvb) å¯ä»¥æå–4ç§è§†é¢‘æ ¼å¼
# 3. (?:è¡¨è¾¾å¼) éæ•è·åˆ†ç»„
# 4. \N å¼•ç”¨ç¼–å·ä¸ºNçš„åˆ†ç»„ eg.(\w)(\w)\2\1 åŒ¹é…ab baè§„åˆ™çš„å•è¯å¦‚otto,asffs
# 5. å…ˆè¡Œæ–­è¨€ eg. å–œæ¬¢(?=ä½ )åªèƒ½åŒ¹é…åé¢æ˜¯ä½ çš„"å–œæ¬¢"ï¼Œå¦‚å–œæ¬¢ä½ ä¸­çš„"å–œæ¬¢"; å–œæ¬¢(?!ä½ )åªèƒ½åŒ¹é…å¦‚å–œæ¬¢æˆ‘ä¸­çš„"å–œæ¬¢"
# 6. åè¡Œæ–­è¨€ eg. (?<=æˆ‘)å–œæ¬¢åªèƒ½åŒ¹é…å¦‚"æˆ‘å–œæ¬¢ä½ "ä¸­çš„"å–œæ¬¢"

# å¤„ç†é¦–å­—æ¯å¤§å†™
# æ­£åˆ™éœ€è¦ä½¿ç”¨\\ï¼Œå› ä¸ºRä¸­\éœ€è¦è½¬ä¹‰
temp <- tolower(month.name)
gsub("^(\\w)","\\U\\1",temp,perl = T)

# åˆ†å‰²å­—ç¬¦ä¸²
strsplit(å­—ç¬¦ä¸²å‘é‡/é›†, "åˆ†éš”ç¬¦") 

# å‘é‡ç¬›å¡å°”ç§¯
A <- 1:3
B <- c("A","B","C")
outer(A,B,FUN = paste)


8. æ—¶é—´åºåˆ— -------------------------------------------------------------------------------------------
a <- as.Date("2021-10-13")
# ç”Ÿæˆæ—¶é—´æ ¼å¼æ•°æ®

seq(as.Date("2020-01-01"),as.Date("2021-01-01"),by=12)
# ç”Ÿæˆé—´éš”12å¤©çš„ç­‰å·®æ—¶åº

sales <- round(runif(n = 48,min = 50,max = 100))
ts(sales,start = c(2010,5),end = c(2011,4),frequency = 12)
# tså‡½æ•°ç”Ÿæˆæ—¶åº

9. è¯»å–æ•°æ® ---------------------------------------------------------------------------------------------------------

patientID <- c(1:4)
admdate <- c("10/15/2019","10/18/2019","10/21/2019","10/24/2019")
age <- c(round(runif(4,min = 20,max = 50)))
diabetes <- c("Type1","Type2","Type3","Type4")
status <- c("Poor","Improved","Excellent","Poor")
data <- data.frame(patientID,admdate,age,diabetes,status)
# ç”Ÿæˆæ•°æ®æ¡†
data2 <- data.frame(patientID=character(),admdate=character(),age=numeric(),diabetes=character(),status=character())
data2 <- edit(data2)
# è¿›å…¥ç¼–è¾‘å™¨

# è¯»å–æ•°æ®åº“
install.packages("RODBC")
library(RODBC)

turnout <- read.csv("C:/Users/three/Desktop/turnout.csv")
headï¼ˆturnoutï¼‰ # è¯»å–å‰6è¡Œ

x <- read.table("input.txt") # é»˜è®¤ç©ºç™½åˆ†å‰²
x <- read.table("input.csv", sep=",", header = T, skip = 5, nrows = 100, 
                    na.strings = " ") 
# é€—å·åˆ†å‰²
# ç¬¬ä¸€è¡Œæ˜¯å¦ä¸ºå˜é‡åç§°
# skipçš„è¡Œæ•°
# nrowsï¼šæ€»å…±å¯¼å…¥å¤šå°‘è¡Œ
# è‡ªåŠ¨è½¬åŒ–ç¼ºå¤±å€¼
    
read.csv() # è¯»å–csvæ–‡ä»¶
read.fwf() # fixed width fileï¼ˆå›ºå®šä½ç½®ï¼ˆå®½åº¦ï¼‰çš„æ–‡ä»¶ï¼‰
    
x <- read.table("website", header = T) # è¯»å–ç½‘ç»œæ–‡ä»¶
    
install.packages("XML") # ç½‘ç»œè¯»å–æ•°æ®çš„åŒ…
readHTMLTable
    
install.packages("foreign") # è¯»å–ä¸åŒè½¯ä»¶æ ¼å¼çš„æ•°æ®çš„åŒ…ï¼Œæ”¯æŒspss SASç­‰è½¯ä»¶çš„æ ¼å¼
help(package = "foreign")
    
# Excelç›´æ¥å¤åˆ¶åˆ°å‰ªè´´æ¿å¯¼å…¥
x <- read.table("clipboard", header = T, sep = "\t") # Windows
x <- read.table(pipe("pbpaste")) # Mac
    
read.table(gzfile("input.txt.gz")) # è¯»å–å‹ç¼©æ–‡ä»¶
    
?readLines
readLines("input.csv", n = 5) # n = è¿”å›è¡Œæ•°ï¼Œå¸¸ç”¨äºéå¸¸è§„æ–‡ä»¶ï¼Œè¿”å›ç»“æœä¸ºå­—ç¬¦ä¸²æ ¼å¼

?scan
scan(file,what) # file=æ–‡ä»¶åœ°å€ï¼ŒwhatæŒ‡å®šè¯»å–æ•°æ®ç±»å‹(å­—ç¬¦/æ–‡æœ¬ç­‰)

10. å†™å…¥æ•°æ® ----------------------------------------------------------------------------------------------------
?write
    write.table(x, file = "x.txt")
    write.table(x, file = "x.csv", sep = "\t", quote = F, append = F, 
                na = "NA", row.names = F)
    # append = Fæ¸…ç©ºæºæ–‡ä»¶ï¼ˆTåŠ åœ¨åŸæ–‡ä»¶åï¼‰
    # quote = Fä¸ä¸ºå­—ç¬¦ä¸²æ·»åŠ ""
    # row.names = Få–æ¶ˆè‡ªåŠ¨æ·»åŠ çš„è¡Œå·
    # file= æ”¹ä¸ºgzfile("xxx")å³å¯ç”Ÿæˆå‹ç¼©æ–‡ä»¶
# foreignåŒ…æä¾›å†™å…¥æ•°æ®ä¸ºå…¶ä»–è½¯ä»¶æ ¼å¼çš„å‡½æ•°(éƒ¨åˆ†)
write.csv

11. è¯»å†™Excelæ–‡ä»¶ ------------------------------------------------------------------------------------------------
# Excelæ–‡ä»¶å¦å­˜ä¸ºcsvæ ¼å¼
    x <- read.csv()
    
# å¤åˆ¶å‰ªè´´æ¿
    x <- read.table(pipe("pbpaste"))
    x <- read.table("clipboard",sep=\t,header=T)
    
# Excelçš„æ ¼å¼ï¼š.xlsx
install.packages("readxl")
library(readxl)
read_excel()
# è¯»å–å•é¡µExcel
library(openxlsx)
readWorkbook()
# è¯»å–å¤šsheeté¡µExcel

12. è¯»å†™Ræ–‡ä»¶ ------------------------------------------------------------------------------------------------
saveRDS(iris,file = "iris.RDS")
readRDS("iris.RDS")
# RDSå‚¨å­˜ä¸€ä¸ªå¯¹è±¡

save(iris,iris3,file="C:/Users/three/test.RData")
# RDataå°±æ˜¯ä¿å­˜æ—¶çš„å·¥ä½œç©ºé—´ï¼Œåç¼€æ˜¯.RData
# load RDataæ–‡ä»¶æ—¶ï¼Œç›¸åŒåå­—çš„å¯¹è±¡ä¼šè¦†ç›–ä¹‹å‰çš„å¯¹è±¡

save.image()
# ä¿å­˜å½“å‰å·¥ä½œç©ºé—´ä¸­çš„æ‰€æœ‰å¯¹è±¡

P 34-37 æ•°æ®å¤„ç†-æ•°æ®è½¬æ¢ ------------------------------------------------------------------------------------------------

1. å¼ºåˆ¶è½¬æ¢æ•°æ®æ ¼å¼

is.data.frame(state.x77)
[1] FALSE
state.x77 <- as.data.frame(state.x77)
is.data.frame(state.x77)
[1] TRUE
# çŸ©é˜µè½¬æ¢ä¸ºæ•°æ®æ¡†

as.matrix(data.frame(state.x77,state.name))
# æ•°æ®æ¡†è½¬åŒ–ä¸ºçŸ©é˜µï¼ˆæ•°å­—ä¼šå˜ä¸ºå­—ç¬¦ï¼‰

method(is)
method(as)
# æŸ¥çœ‹æ‰€æœ‰åˆ¤æ–­å’Œè½¬æ¢å‡½æ•°

x <- state.abb
dim(x) <- c(5,10)
# ä¸ºå‘é‡æ·»åŠ ç»´åº¦å³å¯ç”ŸæˆçŸ©é˜µ
as.factor(x)
# å‘é‡è½¬å› å­
as.list(x)
# å‘é‡è½¬åˆ—è¡¨
unlist(list)
# åˆ—è¡¨è½¬å‘é‡

state <- data.frame(x,state.region,state.x77)
y <- state["Nevada",]
unname(y)
# å»é™¤yä¸­çš„åˆ—å

2. æå–éƒ¨åˆ†æ•°æ®

who <- read.csv("R studio/WHO.csv")
who1 <- who[c(1:20),c(1:10)]
# å‘é‡è¿›è¡Œç´¢å¼•
who2 <- who[which(who$Continent==7)]
# whichå‡½æ•°è¿›è¡Œæ¡ä»¶ç­›é€‰
who3 <- subset(who,who$CountryID<100 &who$CountryID>=50)
# sbusetæå–å­é›†

x <- 1:100
sample(x,40,replace = T)
who4 <- who[sample(who$CountryID,10),]
# sampleæŠ½æ ·å‡½æ•°ï¼Œreplac=T æœ‰æ”¾å›æŠ½æ ·

3. åˆ é™¤æ•°æ®
mtcars[-1:-10,]
# è´Ÿç´¢å¼•åˆ é™¤
mtcars$mpg <- NULL
# æ¸…ç©ºæŒ‡å®šè¡Œ/åˆ—

4. æ·»åŠ åˆå¹¶æ•°æ®æ¡†
data.frame(USArrests,state.division)
cbind(USArrests,state.division)
# åˆå¹¶åˆ—
data1 <- head(USArrests,20)
data2 <- head(USArrests,20)
rbind(data1,data2)
# åˆå¹¶è¡Œï¼ˆåˆ—åéœ€è¦ä¸€è‡´ï¼‰

5. å‰”é™¤é‡å¤å€¼
data1 <- head(USArrests,30)
data2 <- tail(USArrests,30)
data4 <- rbind(data1,data2) # æ­¤æ—¶æœ‰é‡å¤çš„è¡Œ
duplicated(data4) # åˆ¤æ–­é‡å¤å€¼
data4[!duplicated(data4),] # !è¡¨ç¤ºå‰”é™¤é‡å¤å€¼ï¼ˆç±»ä¼¼è´Ÿç´¢å¼•ï¼‰
# ä½¿ç”¨ç´¢å¼•+duplicated
rownames(data4[!duplicated(data4),])
length(rownames(data4[!duplicated(data4),]))

unique(data4)
# ä½¿ç”¨uniqueç›´æ¥å‰”é™¤

6. è½¬ç½®é¢ å€’
sractm <- t(mtcars) # è½¬ç½®
rev(letters) # å‘é‡é¢ å€’
women[rev(rownames(women)),] # è¡Œé¢ å€’

7. æ•°æ®åŠ å‡
women$height*2.54
data.frame(women$height*2.54,women$weight)
# å°†heightè½¬æ¢ä¸ºcmä¸ºå•ä½

transform(women,height=height*2.54)
transform(women,height.cm=height*2.54)
# ä½¿ç”¨transformè¿›è¡Œè½¬æ¢

8. æ•°æ®æ¡†çš„æ’åº
# sort å‘é‡æ’åº
sort(rivers,decreasing = T) # é»˜è®¤decreasing=Fï¼Œä»å°åˆ°å¤§
mtcars[sort(rownames(mtcars)),] # é€šè¿‡æ’åºè¡Œï¼Œæ¥å¯¹æ•°æ®æ¡†æ’åº
order(rivers) # orderè¿”å›å‘é‡çš„ä½ç½®
mtcars[order(mtcars$mpg),] # æ’åºæ•°æ®æ¡†æ›´æ–¹ä¾¿ï¼Œå€’åºå¯è®¾ç½®decreasing = T
mtcars[order(mtcars$mpg,mtcars$disp),] # å¤šæ¡ä»¶æ’åº

9. æ•°æ®æ¡†æ±‚å’Œå–å‡å€¼åŠåˆ†ç±»ç­‰
worldPhones <- as.data.frame(WorldPhones)
rs <- rowSums(worldPhones)
cm <- colMeans(worldPhones)
total <- cbind(worldPhones,total=rs)
rbind(total,mean=cm)

# applyç³»åˆ—å‡½æ•°

# apply for dataframe, matrix
apply(data, MARGIN = 1, FUN = sum()) # MARGIN = 1->è¡Œ
apply(data, MARGIN = 2, FUN = mean()) # MARGIN = 2->åˆ—

# lapply for list
lapply(list, FUN = length()) 

# sapply for vector, matrix

# tapply for factor
tapply(state.name, state.division, FUN = length) # ç¬¬äºŒä¸ªæ˜¯å› å­ï¼Œä¹Ÿæ˜¯åˆ†ç±»æ¡ä»¶ï¼Œlengthæ˜¯æ±‚é›†åˆä¸­å…ƒç´ çš„ä¸ªæ•°

10. æ•°æ®ä¸­å¿ƒåŒ–å’Œæ ‡å‡†åŒ–
# ä¸­å¿ƒåŒ– x-mean(x) center
# æ ‡å‡†åŒ– ï¼ˆx-mean()xï¼‰/sd(x) scale
scale(x = state.x77,center = T,scale = T)
heatmap(scale(x = state.x77,center = T,scale = T))

P38-40 reshape2ï¼Œtidyrï¼Œdplyr ------------------------------------------------------------------------------------------------

1. reshape2
# merge åˆå¹¶åŒç±»é¡¹
x <- data.frame(k1=c(NA,NA,3,4,5),k2=c(1,NA,NA,4,5),data=1:5)
y <- data.frame(k1=c(NA,2,NA,4,5),k2=c(NA,NA,3,4,5),data=1:5)
merge(x,y,by = "k1")
merge(x,y,by = "k2",incomparables = T) # NAçš„æƒ…å†µä¸¤ä¸¤ç»„åˆ
merge(x,y,by=c("k1","k2"))

# reshape æ‰æ•°æ®
melt(airquality) #èåˆæ•°æ®ï¼Œå°†å®½æ•°æ®å˜ä¸ºé•¿æ•°æ®
aql <- melt(airquality,id.vars = c("month","day")) #ä»¥æœˆä»½+æ—¥æœŸä½œä¸ºid
aqw <- dcast(data = aql,formula = month+day~variable) # é•¿å˜å®½ï¼šmonth+dayä½œä¸ºidï¼Œvariableåˆ—çš„å„ä¸ªfactorä½œä¸ºæ–°çš„åˆ—å
aqw <- dcast(aql,formula = month ~variable,fun.aggregate = sum,na.rm=T) # ä»¥monthä¸ºidæ±‡æ€»ï¼Œå€¼ä¸ºå„ä¸ªdayçš„æ±‚å’Œ

2. tidyr
# æ‰æ•°æ®gather 
tdata <- mtcars[1:10,1:3]
tdata <- data.frame(names=rownames(tdata),tdata)
gather(tdata,key = "KEY",value = "VALUE",mpg:disp)
# å®½å˜é•¿
gdata <- gather(tdata,key = "KEY",value = "VALUE",mpg:disp)
spread(gdata, key = "KEY", value = "VALUE")
# é•¿å˜å®½

# åˆ†åˆ—åŠåˆå¹¶
df <- data.frame(x=c(NA,"a.b","a.c","b.a"))
separate(df,col = x,into = c("A","B")) # é»˜è®¤è¯†åˆ«åˆ†éš”ç¬¦
df2 <- data.frame(x=c(NA,"a.b-c","a-c","b-a"))
separate(df2,col = x,into = c("A","B"),sep="-") # æŒ‡å®šåˆ†éš”ç¬¦
x <- separate(df2,col = x,into = c("A","B"),sep="-")
unite(x,col = "AB", A,B,sep = "+") #æŒ‡å®šè¿æ¥ç¬¦ï¼Œåˆå¹¶

3. dplyr
# å‰”é™¤æ•°æ®
dplyr::filter(iris,Sepal.Length>7) #è¿‡æ»¤æ‰ä¸ç¬¦åˆåé¢é€»è¾‘çš„è¡Œ
dplyr::distinct(rbind(data[1:10,], data[1:15,])) # distinctå»æ‰é‡å¤çš„è¡Œ

# æŠ½å–æ•°æ®
dplyr::slice(data, 10:15) # å–å‡ºæ•°æ®æŒ‡å®šè¡Œ
dplyr::sample_n(data, n) # éšæœºå–å‡ºnè¡Œ
dplyr::sample_frac(data, 0.1) # æŒ‰æ¯”ä¾‹éšæœºå–å‡ºè¡Œ
dplyr::slice_sample(data) # éšæœºå–1è¡Œ

# æ•°æ®æ’åº
dplyr::arrange(data, c2) # æŒ‰ç…§æŸä¸€åˆ—çš„å¤§å°æ¥æ’åºï¼ˆä»å°åˆ°å¤§ï¼‰
dplyr::arrange(data, desc(c2)) # æŒ‰ç…§æŸä¸€åˆ—ç›¸åçš„å¤§å°æ¥æ’åºï¼ˆä»å¤§åˆ°å°ï¼‰

# æ•°æ®æå–ï¼ˆå˜é‡ï¼‰
dplyr::select()

# æ•°æ®ç»Ÿè®¡
summarise(data, avg = mean(c2))
summarise(data, sum = sum(c2))

# é“¾å¼æ“ä½œç¬¦ %>%ï¼ˆç®¡é“ï¼‰å¿«æ·é”®ï¼šCtrl+shift+M
# ç›¸å½“äºâ€œç„¶åâ€
dplyr::group_by(data, c5) # é€šè¿‡åˆ¶å®šåˆ—çš„å› å­æ¥è¿›è¡Œåˆ†ç»„ï¼Œæ¯ä¸€ç§å› å­ä¸ºä¸€ç»„ã€‚
data %>% group_by(c5) # å¦ä¸€ç§å†™æ³•
data %>% group_by(c5) %>% summarise(avg = mean(c2)) %>% arrange((avg))
# å…ˆåˆ†ç»„ï¼Œå†ç®—å¹³å‡å€¼ï¼Œå†æ’åº

# æ·»åŠ å˜é‡
dplyr::mutate(data, new=c2+c3) # åŠ æ–°çš„ä¸€åˆ—ï¼Œå¹¶æ·»åŠ é€»è¾‘

# åŒè¡¨æ ¼åˆå¹¶
a <- data.frame(x1 = c("A","B","C"), x2 = c(1,2,3))
b <- data.frame(x1 = c("A","B","D"), x2 = c(T,F,T))
dplyr::left_join(a,b,by="x1") # å·¦è¿æ¥ï¼Œx1ä»¥aä¸ºå‡†
dplyr::right_join(a,b,by="x1") # å³è¿æ¥ï¼Œx1ä»¥bä¸ºå‡†
dplyr::full_join(a, b, by="x1") # å–x1çš„å¹¶é›†
dplyr::semi_join(a, b, by="x1") # å–x1çš„äº¤é›†
dplyr::anti_join(a, b, by="x1") # å–aä¸bä¸åŒçš„x1
  x1 x2
1  C  3

first <- dplyr::slice(mtcars,1:5)
second <- dplyr::slice(mtcars,3:8)
dplyr::intersect(first,second) # å–äº¤é›†
dplyr::union_all(first,second) # å–å¹¶é›†
dplyr::setdiff(first,second) # å–secondçš„è¡¥é›†

# P42     é€‰é¡¹å‚æ•°---------------------------------------------------------------------------------------------

1. è¾“å…¥æ§åˆ¶éƒ¨åˆ†
# å¯ä»¥è¾“å‡ºå“ªç§ç±»å‹çš„æ•°æ®
# fileï¼šæ¥ä¸€ä¸ªæ–‡ä»¶
# dataï¼šä¸€èˆ¬æŒ‡è¦è¾“å…¥ä¸€ä¸ªæ•°æ®æ¡†
# xï¼šä¸€ä¸ªå•ç‹¬çš„å¯¹è±¡ï¼Œä¸€èˆ¬æ˜¯å‘é‡ï¼Œä½†ä¹Ÿå¯èƒ½æ˜¯çŸ©é˜µæˆ–è€…åˆ—è¡¨
# xå’Œyï¼šå‡½æ•°éœ€è¦ä¸¤ä¸ªè¾“å…¥å˜é‡
# x, y, zï¼šå‡½æ•°éœ€è¦ä¸‰ä¸ªè¾“å…¥å˜é‡
# formulaï¼šå…¬å¼
# na.rmï¼šæ˜¯å¦åˆ é™¤ç¼ºå¤±å€¼
# ...è¡¨ç¤ºå‚æ•°å¯ä¼ é€’(ä¸å…¶ä»–å‡½æ•°ç›¸åŒ)ï¼Œæˆ–æ²¡æœ‰æ•°é‡é™åˆ¶
# ~ è¡¨ç¤ºç›¸å…³

2. è¾“å‡ºæ§åˆ¶éƒ¨åˆ†
# ç±»ä¼¼è¾“å‡º

3. è°ƒèŠ‚éƒ¨åˆ†
# ï¼ˆ1ï¼‰æ ¹æ®åå­—åˆ¤æ–­é€‰é¡¹çš„ä½œç”¨ï¼š
# coloré€‰é¡¹ï¼šæ§åˆ¶é¢œè‰²
# select ä¸é€‰æ‹©æœ‰å…³
# font ä¸å­—ä½“æœ‰å…³
# font.axis åæ ‡è½´çš„å­—ä½“
# lty = line type
# lwd = line width
# method è½¯ä»¶ç®—æ³•

# ï¼ˆ2ï¼‰é€‰é¡¹æ¥å—å“ªäº›å‚æ•°ï¼š
# mainï¼šå­—ç¬¦ä¸²ï¼Œä¸èƒ½æ˜¯å‘é‡
# na.rmï¼šTRUE or FALSE
# axisï¼šsideå‚æ•°åªèƒ½æ˜¯1åˆ°4
# figï¼šåŒ…å«å››ä¸ªå…ƒç´ çš„å‘é‡(æ§åˆ¶ä½ç½®)ï¼Œä¸å–å€¼å¯èƒ½æ˜¯NULLæˆ–è€…NA
# method å‚æ•°ä¸ç®—æ³•ç›¸å…³

# P43     æ•°å­¦ç»Ÿè®¡å‡½æ•°------------------------------------------------------------------------------------------
# Ræ¦‚ç‡åˆ†å¸ƒå‡½æ•°
      # d æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆdensityï¼‰
      # p åˆ†å¸ƒå‡½æ•°ï¼ˆdistributionï¼‰
      # q åˆ†å¸ƒå‡½æ•°çš„åå‡½æ•°ï¼ˆquantumï¼‰
      # r äº§ç”Ÿç›¸åŒåˆ†å¸ƒçš„éšæœºæ•°ï¼ˆrandomï¼‰
set.seed(n) # æ¯æ¬¡è¿è¡Œå¯ä»¥ä½¿ä¹‹åçš„éšæœºæ•°ç›¸åŒï¼Œnä¸ºç§å­ç¼–ç 

# P44     æè¿°æ€§ç»Ÿè®¡å‡½æ•°-----------------------------------------------------------------------------------------
1. æè¿°ç»Ÿè®¡
summary()
# æä¾›å‘é‡çš„å„é¡¹æ•°æ®ï¼Œæ¯”å¦‚æœ€å¤§å°å€¼ã€å¹³å‡å€¼ã€å››åˆ†ä½æ•°ã€å› å­é¢‘æ•°å‘é‡ç»Ÿè®¡ç­‰
fivenum(myvars$hp)
# è¿”å›äº”ä¸ªæ•°ï¼šæœ€å°å€¼ã€å››åˆ†ä½æ•°ç¬¬ä¸€ã€ä¸­ä½æ•°ã€å››åˆ†ä½æ•°ç¬¬ä¸‰ã€æœ€å¤§å€¼
describe (Hmisc) 
stat.desc (pastecs) # basic = T è®¡ç®—åŸºæœ¬å€¼ï¼Œdesc = T è®¡ç®—æè¿°å€¼ï¼Œnorm = T è®¡ç®—ç»Ÿè®¡å€¼
describe(psych) # trims=0.1ï¼Œå»æ‰æœ€ä½å’Œæœ€é«˜10%çš„éƒ¨åˆ†ï¼ˆåˆ‡å°¾å‡å€¼ï¼‰

2. åˆ†ç±»ç»Ÿè®¡
aggregate(MASS) # æŒ‰æ¡ä»¶åˆ†ç±»è¿›è¡Œæè¿°ç»Ÿè®¡ï¼Œå¯ä»¥æŒ‰å¤šä¸ªå˜é‡è¿›è¡Œåˆ†ç±»,ä½†åªèƒ½ä½¿ç”¨ä¸€ä¸ªç»Ÿè®¡å‡½æ•°
aggregate(Cars93[c("Min.Price","Price","Max.Price","MPG.city")],by = list(Manufacturer=Cars93$Manufacturer,Origin=Cars93$Origin),summary)
summaryBy(doBy) # FUNå¯ä»¥æ˜¯c(mean,sum)çš„å½¢å¼
summaryBy(x2+x3~x1,data=X,FUN = sd)
describeBy(psych) # æ²¡åŠæ³•ä½¿ç”¨è‡ªå®šä¹‰çš„å‡½æ•°
describeBy(mtcars[myvars], list(am=mtcars$am))
describeBy(psych)

# P45     é¢‘æ•°ç»Ÿè®¡å‡½æ•°-------------------------------------------------------------------------------------------

1. ä¸€ç»´
table() é¢‘æ•°
mtcars$cyl <- as.factor(mtcars$cyl)
cut(mtcars$mpg,c(seq(10,50,10)))
table(mtcars$cyl)
table(cut(mtcars$mpg,c(seq(10,50,10))))
prop.table() é¢‘ç‡
prop.table(table(mtcars$cyl))

2. äºŒç»´ vcdåŒ…
table(Arthritis$Treatment, Arthritis$Improved)
with(data=Arthritis, table(Treatment, Improved)) # ä½¿ç”¨withé¿å…é‡å¤è¾“å…¥æ•°æ®é›†åç§°
x <- xtabs(~ Treatment + Improved, data = Arthritis)
margin.table(x, 1) #è¾¹é™…é¢‘æ•°
prop.table(x, 1) #æŒ‰è¡Œçš„æ€»å’Œè®¡ç®—é¢‘ç‡
# 1 = åªæ·»åŠ è¡Œ
# 2 = åªæ·»åŠ åˆ—

3. ä¸‰ç»´
y <- xtabs(~ Treatment + Improved + Sex, data = Arthritis)
ftable(y) # å¹³é“ºå¼çš„åˆ—è”è¡¨

# P46     ç‹¬ç«‹æ€§æ£€éªŒå‡½æ•°-------------------------------------------------------------------------------------------

1. å¡æ–¹æ£€éªŒ
mytable <- table(Arthritis$Treatment, Arthritis$Improved) # å˜é‡çš„é¡ºåºä¸é‡è¦
chisq.test(mytable)

2. è´¹å¸Œå°”ç²¾ç¡®æ£€éªŒ
mytable <- xtabs(~Treatment+Improved, data=Arthritis) 
fisher.test(mytable)

3. CMHæ£€éªŒ
mytable <- xtabs(~Treatment+Improved+Sex, data=Arthritis) # å˜é‡çš„é¡ºåºå¾ˆé‡è¦ï¼ˆå› ä¸ºè¦ä¸‰ä¸ªå˜é‡ï¼‰
mantelhaen.test(mytable)

# P47-48     ç›¸å…³æ€§åˆ†æåŠæ£€éªŒ--------------------------------------------------------------------------------------
# ä½¿ç”¨cor()è®¡ç®—ç›¸å…³ç³»æ•°
cor(state.x77) # é»˜è®¤method="pearson"
cor(state.x77, method="spearman")
# ä½¿ç”¨cov()è®¡ç®—åæ–¹å·®
cov(state.x77) 
# è®¡ç®—éƒ¨åˆ†å…ƒç´ çš„ç›¸å…³ç³»æ•°
x <- state.x77[, c(1,2,3,6)]
y <- state.x77[, c(4,5)]
cor(x, y)

# partial correlations åç›¸å…³ç³»æ•°
pcor(c(1,5,2,3,6), cov(state.x77)) # åç›¸å…³ç³»æ•°çš„è®¡ç®—éœ€è¦ç”¨åˆ°covåæ–¹å·®
# è®¡ç®—state.x77ç¬¬1ï¼Œ5å˜é‡ä¹‹é—´çš„åç›¸å…³ç³»æ•°ï¼Œ2,3,6ä½œä¸ºæ§åˆ¶å˜é‡

# ç›¸å…³æ€§æ£€éªŒ
cor.test(state.x77[,3], state.x77[,5])
corr.test(state.x77) #è¾“å‡ºç›¸å…³ç³»æ•°åŠpå€¼

# åç›¸å…³æ€§æ£€éªŒ
x <- pcor(c(1,5,2,3,6), cov(state.x77)) # å…ˆå¾—åˆ°åç›¸å…³ç³»æ•°
pcor.test(x, 3, 50) # 3 -> æ§åˆ¶å˜é‡æ•°ï¼Œ50 -> æ ·æœ¬æ•°

# tæ£€éªŒ
library(MASS)
t.test(UScrime) # å•æ ·æœ¬tæ£€éªŒ
t.test(Prob ~ So, data=UScrime) # ä¸¤ç‹¬ç«‹æ ·æœ¬tæ£€éªŒï¼Œæ ¹æ®Soåˆ†2ç»„è¿›è¡Œtæ£€éªŒï¼ŒåŸå‡è®¾ä¸ºå—åŒ—æ— å·®åˆ«


# P49     ç»˜å›¾å‡½æ•°-----------------------------------------------------------------------------------------------------

#1. RåŸºç¡€ç»˜å›¾åŒ…graphics
# é«˜çº§ç»˜å›¾ï¼šä¸€æ­¥åˆ°ä½ï¼Œç›´æ¥ç»˜åˆ¶å‡ºå›¾
# ä½çº§ç»˜å›¾ï¼šä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œå¾—åœ¨é«˜çº§ç»˜å›¾äº§ç”Ÿå›¾å½¢çš„åŸºç¡€ä¸Šï¼Œå¯¹å›¾å½¢è¿›è¡Œè°ƒæ•´ï¼Œæ¯”å¦‚åŠ çº¿ã€æ ‡é¢˜æ–‡å­—ç­‰
# è¾“å…¥æ•°æ®çš„æ ¼å¼ï¼š æ•£ç‚¹å›¾ï¼šxå’Œyä¸¤ä¸ªåæ ‡æ•°æ®ï¼›ç›´æ–¹å›¾ğŸ“Šï¼šå› å­ï¼›çƒ­åŠ›å›¾ï¼šæ•°æ®çŸ©é˜µ

1.1 plot
plot(mtcars$cyl) # æ•£ç‚¹å›¾
plot(as.factor(mtcars$cyl)) # ç›´æ–¹å›¾
plot(as.factor(mtcars$cyl), mtcars$carb) # ç®±çº¿å›¾
plot(mtcars$carb, as.factor(mtcars$cyl)) # æ•£åˆ—å›¾
plot(as.factor(mtcars$cyl), as.factor(mtcars$carb)) # æ£˜æŸ±å›¾

psï¼šplot(women$height ~ women$weight) # å¦ä¸€ç§å†™æ³•

fit <-lm(height ~ weight, data=women)
plot(fit) # plotä¼šè‡ªåŠ¨æ£€æµ‹è¾“å…¥çš„æ•°æ®ç±»å‹æ¥è¿›è¡Œä¸åŒçš„ç»˜å›¾
methods(plot) # å› ä¸ºplotå†…å«å¤šç§å­å‡½æ•°(æ ¼å¼)

2.par
par() # è¾“å‡ºç»˜å›¾å„ä¸ªå‚æ•°
plot(as.factor(mtcars$cyl), col=c("red", "green", "blue")) # colä¸ºparçš„å…¶ä¸­ä¸€é¡¹å‚æ•°
